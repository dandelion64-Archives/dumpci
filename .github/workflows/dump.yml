name: Dump
 
on:
  push:
    paths-ignore:
      - '*.md'
    branches: [ main ]

defaults:
  run:
    shell: bash

env:
  ROM_URL:  https://download.wetransfer.com/usgv/7b307aa5ffceb8a3b9d503107a1d570820221229141931/4dde48a86b0a5e00b14b3f06a6cf9431e5d43e0a/%5BGsmXpro.com%5D_M115F-COMBINATION_JDM_QL1871B_FAC_M115FXX1F080_200519.zip?token=eyJhbGciOiJIUzI1NiJ9.eyJpYXQiOjE2NzIzODkyODQsImV4cCI6MTY3MjM4OTg4NCwidW5pcXVlIjoiN2IzMDdhYTVmZmNlYjhhM2I5ZDUwMzEwN2ExZDU3MDgyMDIyMTIyOTE0MTkzMSIsImZpbGVuYW1lIjoiW0dzbVhwcm8uY29tXV9NMTE1Ri1DT01CSU5BVElPTl9KRE1fUUwxODcxQl9GQUNfTTExNUZYWDFGMDgwXzIwMDUxOS56aXAiLCJ3YXliaWxsX3VybCI6Imh0dHA6Ly9zdG9ybS1pbnRlcm5hbC5zZXJ2aWNlLnVzLWVhc3QtMS53ZXRyYW5zZmVyLm5ldC9hcGkvd2F5YmlsbHM_c2lnbmVkX3dheWJpbGxfaWQ9ZXlKZmNtRnBiSE1pT25zaWJXVnpjMkZuWlNJNklrSkJhSE5MZDJWNFNqSXpNeUlzSW1WNGNDSTZJakl3TWpJdE1USXRNekJVTURnNk5EUTZORFF1TURBd1dpSXNJbkIxY2lJNkluZGhlV0pwYkd4ZmFXUWlmWDAtLThlMzlmODAwZjVlMzc0MjUwZjYzYjYyYTYzYzFkZmJjMWVmNjgwYzM5ZTZhMjEyMzhjZTE5ZWQxYWUwMjkwZGEiLCJmaW5nZXJwcmludCI6IjRkZGU0OGE4NmIwYTVlMDBiMTRiM2YwNmE2Y2Y5NDMxZTVkNDNlMGEiLCJjYWxsYmFjayI6IntcImZvcm1kYXRhXCI6e1wiYWN0aW9uXCI6XCJodHRwOi8vZnJvbnRlbmQuc2VydmljZS5ldS13ZXN0LTEud2V0cmFuc2Zlci5uZXQvd2ViaG9va3MvYmFja2VuZFwifSxcImZvcm1cIjp7XCJ0cmFuc2Zlcl9pZFwiOlwiN2IzMDdhYTVmZmNlYjhhM2I5ZDUwMzEwN2ExZDU3MDgyMDIyMTIyOTE0MTkzMVwiLFwiZG93bmxvYWRfaWRcIjoxNzQ5MzI1ODU3M319In0.L_m6fPg3gfWR4ouyj33maL1Ky_bQ_HXYKN5qd4Nwb_Y&cf=y

jobs:
  build:
    runs-on: ubuntu-latest
    privileged: true

    steps:
       - name: Checkouts
         uses: actions/checkout@v2

       - name: Clone Dumpyara
         run: |
              git clone https://github.com/fw-dumps/firmware_dumper dumper
       - name: Setup Dumpyara environment
         working-directory: dumper
         run: |
              sudo bash setup.sh
              git config --global user.name "atharvnegi"
              git config --global user.email "atharvnegi2951@gmail.com"
       - name: Setup config envs
         working-directory: dumper
         run: |
              echo "${{ secrets.GIT_TOKEN }}" > .github_token
              echo "${{ secrets.GIT_ORG_NAME }}" > .github_orgname
              echo "${{ secrets.BOT_TOKEN }}" > .tg_token
              echo "${{ secrets.CHAT_ID }}" > .tg_chat
       - name: Running Dumpyara
         working-directory: dumper
         run: |
              ./dump.sh $ROM_URL
